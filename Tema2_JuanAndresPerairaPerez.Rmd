---
title: "Ejercicios tema 2"
author: "Juan Andrés Peraira Pérez"
date: "13 de abril de 2018"
output: pdf_document
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Ejercicio 1: Utiliza los datos “iris” que corresponden a mediciones (en centímetros) de 4 variables: largo y ancho de los pétalos y sépalos; para 50 flores de 3 especies distintas de plantas Iris setosa, versicolor, y virginica.
Queremos responder a las siguientes preguntas:

¿Cuántos datos (o casos) tenemos para cada especie? y ¿qué porcentaje representan del total de casos?
Realice los gráficos pertinentes para cada tipo de variable (cualitativa vs. cuantitativa).

```{r , echo=TRUE, message=FALSE, warning=FALSE}
datos<-iris #-- cargamos los datos
head(datos)
attach(datos) #-- activamos las variables
table(Species)
#-- Podemos observar que tenemos 50 casos para cada especie
table(Species)/length(Species)
```
El porcentaje es de un 33,33% por especie con respecto al total de datos.
Comenzaremos con los  Gráficos para las variables cuantitativas, en primer lugar se realizaran los diagramas de cajas y bigotes
```{r , echo=TRUE, message=FALSE, warning=FALSE}
library(ggplot2)
p <- ggplot(datos,aes(Species,Sepal.Length))
p +
  labs(x = "Especies",y = "Longitud Sépalo",
       title="Diagrama de Cajas y bigotes")+
  scale_fill_discrete(guide_legend(title = "Especies"))+
  geom_boxplot(aes(fill=Species))

p <- ggplot(datos,aes(Species,Sepal.Width))
p +
  labs(x = "Especies",y = "Ancho Sépalo",
       title="Diagrama de Cajas y bigotes")+
  scale_fill_discrete(guide_legend(title = "Especies"))+
  geom_boxplot(aes(fill=Species))

p <- ggplot(datos,aes(Species,Petal.Length))
p +
  labs(x = "Especies",y = "Longitud Pétalo",
       title="Diagrama de Cajas y bigotes")+
  scale_fill_discrete(guide_legend(title = "Especies"))+
  geom_boxplot(aes(fill=Species))

p <- ggplot(datos,aes(Species,Petal.Width))
p +
  labs(x = "Especies",y = "Ancho Sépalo",
       title="Diagrama de Cajas y bigotes")+
  scale_fill_discrete(guide_legend(title = "Especies"))+
  geom_boxplot(aes(fill=Species))
```

A continuación se presentan los histrogramas para cada variable por especie.

```{r , echo=TRUE, message=FALSE, warning=FALSE}
ggplot(datos, aes(x = Sepal.Length, fill=Species)) + 
  labs(x = "Longitud Sépalo",
       title="Histograma longitud del Sépalo")+
  scale_fill_discrete(guide_legend(title = "Especies"))+
geom_histogram()

ggplot(datos, aes(x = Sepal.Width, fill=Species)) +
  labs(x = "Ancho Sépalo",
       title="Histograma Ancho del Sépalo")+
  scale_fill_discrete(guide_legend(title = "Especies"))+
geom_histogram()

ggplot(datos, aes(x = Petal.Length, fill=Species)) +
  labs(x = "Longitud Pétalo",
       title="Histograma Longitud del Pétalo")+
  scale_fill_discrete(guide_legend(title = "Especies"))+
geom_histogram()

ggplot(datos, (aes(x = Petal.Width, fill=Species))) +
  labs(x = "Ancho Pétalo",
       title="Histograma Ancho del Pétalo")+
  scale_fill_discrete(guide_legend(title = "Especies"))+
geom_histogram()

```
 los gráficos para las variables cualitativas, que en este caso, se trata de la especie

¿Cuál es la media clásica y robusta del ancho del sépalo para cada especie?. Realice diagrama de cajas.

```{r , echo=TRUE, message=FALSE, warning=FALSE}
#-- Media clásica del ancho del sépalo para cada especie.
media_ancho_sepalo<-aggregate(Sepal.Width~Species, datos, mean)
media_ancho_sepalo

#-- Media robusta del ancho del sépalo para cad especie.

library(WRS2)
media_robusta_ancho_sepalo<-aggregate(Sepal.Width~Species, datos, mest)
media_robusta_ancho_sepalo


```
¿Qué correlaciones existen entre las distintas medidas tomadas a cada planta? Realice un gráfico bidimensional para observarlo.
```{r , echo=TRUE, message=FALSE, warning=FALSE}

```

## Ejercicio 2: Utiliza los datos “Davis” (paquete “car”) para calcular el IMC como se indicó en el tema 2 (IMC=Peso/Estatura^2). Realia:

Gráfico de barras y de sectores para las categorías del IMC por sexo.
```{r , echo=TRUE, message=FALSE, warning=FALSE}
#-- cargamos los datos
library(car)
datos<-Davis
head(datos)

attach(datos) #-- Activamos las variables

#-- Creamos la función
imc=function(w,h){w/(h/100)^2}
#-- Calculamos el imc para los datos
datos_imc<-imc(datos$weight,datos$height)
# creamos las categorías de IMC
imcc_datos=cut(datos_imc, breaks=c(0, 15, 18.5, 25, 30))
#-- Creamos la tabla
imcfrec=table(imcc_datos)
cbind(imcfrec)
#-- agregamos las etiquetas
levels(imcc_datos)=c("infrapeso","delgada","normal","sobrepeso","obesidad")
#-- Creamos el data frame
datos_davis<-data.frame(datos, IMC=datos_imc, IMCc=imcc_datos)
# eliminamos los errores
datos_davis<-datos_davis[!is.na(datos_davis$IMCc),]
head(datos_davis)

library(ggplot2)
library(gridExtra)
ggplot(datos_davis,aes(x=factor(sex),fill=factor(IMCc))) +
  geom_bar(stat = "count", position="dodge")+
  labs(title = "Gráfico de IMC por Sexo") +
  labs(fill = "IMC") +
  labs(aes(x="Sexo",y="Personas"))

#-- Gráfico de sectores
#-- Realizaremos dos gráficos separando los hombres ylas mujeres

#-- Gráfrico para los hombres
datos_hombres<-subset(datos_davis,datos_davis$sex=="M")
library(plotrix)
grafico_tarta<-pie(table(datos_hombres$IMCc),
                   main="Gráfico Hombres")

#-- Gráfico para las mujeres

datos_mujeres<-subset(datos_davis,datos_davis$sex=="F")
grafico_tarta<-pie(table(datos_mujeres$IMCc))


```

Gráficos de cajas e histogramas para la variable IMC numérica, también por sexo. ¿Existe algún outlier?, ¿cuáles?.
```{r , echo=TRUE, message=FALSE, warning=FALSE}

```

Interpreta los resultados.
```{r , echo=TRUE, message=FALSE, warning=FALSE}

```

## Ejercicio 3:  Utiliza los datos “Arthritis” (paquete “vcd”) sobre un ensayo clínico de doble ciego que investiga un nuevo tratamiento para la artritis reumatoide. Tenemos información de 84 observaciones de 5 variables: la identificación del paciente (ID), el tratamiento (Treatment: Placebo, Treated), el sexo (Sex: Female, Male), la edad (Age) y la mejoría (Improved: None, Some, Marked). Obtener las tablas de frecuencias y  medidas de asociación entre estas variables. Interpreta los resultados.

```{r , echo=TRUE, message=FALSE, warning=FALSE}
#-- Cargamos el paquete
library(vcd)
datos<-Arthritis
attach(datos) #-- Activamos las variables

#-- Las tablas de frecuencia se realizarán por variable.
#-- Tabla de frecuencias de la variable Tratamiento
table(Treatment)

#-- Tabla de frecuencias de la variable Sexo
table(Sex)

#-- Tabla de frecuencias de la variable Edad
table(Age)

#-- Tabla de frecuencias de la variable Improved
table(Improved)

```






